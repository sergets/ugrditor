<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="xsl/projects.xsl"?>
<page xmlns:sxml="http://sergets.ru/sxml">
    <sxml:select 
        tag="projects" entry="project" entry-class="project" attrs="sxml:time sxml:user sxml:visible-to"
        sxml:update="projects" from="projects" sxml:id="projects"/>
    <sxml:action name="create" sxml:open-to="#">
        <sxml:var name="name" from="post" value="name"/>
        <sxml:var name="descr" from="post" value="descr"/>
        <sxml:var name="rights" from="post" value="rights"/>
        <sxml:update tag="projects"/>
        <sxml:insert into="projects" uses="name descr rights">
            <name>:name</name>
            <descr>:descr</descr>
            <sxml:open-to>:rights</sxml:open-to>
            <sxml:visible-to>:rights</sxml:visible-to>
        </sxml:insert>
    </sxml:action>
    <sxml:action name="edit" sxml:open-to="#">
        <sxml:var name="project" from="post" value="project"/>
        <sxml:var name="name" from="post" value="name"/>
        <sxml:var name="descr" from="post" value="descr"/>
        <sxml:update tag="messages"/>
        <sxml:edit in="projects" id=":project" uses="project name descr rights">
            <name>:name</name>
            <descr>:descr</descr>
            <sxml:open-to>:rights</sxml:open-to>
            <sxml:visible-to>:rights</sxml:visible-to>
        </sxml:edit>
    </sxml:action>
</page>